<div class="articulos-rurales-container">
  <!-- Header de la sección -->
  <div class="section-header">
    <div class="container">
      <!-- Botón de volver -->
      <div class="back-button-container">
        <button 
          class="back-button" 
          (click)="goBack()" 
          type="button"
          id="btnVolver">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 12H5M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Volver al Inicio
        </button>
      </div>
      
      <div class="header-content">
        <h1>Cercos Perimetrales</h1>
        <p class="section-subtitle">Soluciones profesionales en cercos y delimitación de espacios</p>
        
        <!-- Botón toggle filtros (móvil) -->
        <button class="toggle-filtros-btn" (click)="toggleFiltros()">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"/>
          </svg>
          Filtros
        </button>
      </div>
    </div>
  </div>

  <!-- Contenido principal -->
  <div class="main-content">
    <div class="container">
      <div class="content-grid">
        
        <!-- Sidebar con filtros -->
        <aside class="sidebar-filtros" [class.sidebar-visible]="mostrarFiltros">
          <div class="filtros-content">
            
            <!-- Buscador -->
            <div class="filtro-grupo">
              <h3>Buscar Productos</h3>
              <div class="search-container">
                <input 
                  type="text" 
                  [(ngModel)]="busqueda" 
                  (input)="aplicarFiltros()"
                  placeholder="Buscar cercos..."
                  class="search-input">
                <svg class="search-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                </svg>
              </div>
            </div>

            <!-- Filtros por precio -->
            <div class="filtro-grupo">
              <h3>Por Precio</h3>
              <div class="precio-options">
                <label class="filter-checkbox">
                  <input 
                    type="checkbox" 
                    [checked]="filtros.conPrecio" 
                    (change)="toggleConPrecio()">
                  <span class="checkmark"></span>
                  Con precio
                </label>
                <label class="filter-checkbox">
                  <input 
                    type="checkbox" 
                    [checked]="filtros.sinPrecio" 
                    (change)="toggleSinPrecio()">
                  <span class="checkmark"></span>
                  Consultar precio
                </label>
              </div>
            </div>

            <!-- Filtros por categoría -->
            <div class="filtro-grupo">
              <h3>Categorías</h3>
              <div class="categoria-list">
                <button 
                  *ngFor="let categoria of categorias"
                  class="categoria-btn"
                  [class.active]="filtros.categoria === categoria.id"
                  (click)="filtrarPorCategoria(categoria.id)">
                  <span class="categoria-nombre">{{categoria.nombre}}</span>
                  <span class="categoria-count">({{categoria.cantidad}})</span>
                </button>
              </div>
            </div>

            <!-- Filtros por marca -->
            <div class="filtro-grupo">
              <h3>Marcas</h3>
              <div class="marca-list">
                <button 
                  *ngFor="let marca of marcas"
                  class="marca-btn"
                  [class.active]="filtros.marca === marca.id"
                  (click)="filtrarPorMarca(marca.id)">
                  <span class="marca-nombre">{{marca.nombre}}</span>
                  <span class="marca-count">({{marca.cantidad}})</span>
                </button>
              </div>
            </div>

            <!-- Limpiar filtros -->
            <div class="filtro-grupo">
              <button class="limpiar-filtros-btn" (click)="limpiarFiltros()">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
                Limpiar Filtros
              </button>
            </div>

          </div>
        </aside>

        <!-- Grid de productos -->
        <main class="productos-grid">
          
          <!-- Contador de resultados -->
          <div class="resultados-header" *ngIf="!cargando">
            <h2>Productos Encontrados: {{articulosFiltrados.length}}</h2>
          </div>

          <!-- Mensaje de carga -->
          <div *ngIf="cargando" class="loading-container">
            <div class="loading-content">
              <div class="spinner"></div>
              <p>Cargando productos...</p>
            </div>
          </div>

          <!-- Grid de artículos -->
          <div class="articulos-grid" *ngIf="!cargando">
            <div 
              *ngFor="let articulo of articulosFiltrados" 
              class="articulo-card">
              
              <!-- Imagen del producto -->
              <div class="articulo-imagen">
                <img [src]="getImagenUrl(articulo)" [alt]="articulo.nombre" loading="lazy">
                <div class="articulo-overlay">
                  <button class="btn-ver-detalle" (click)="verDetalleArticulo(articulo)">
                    Ver Detalle
                  </button>
                </div>
                
                <!-- Badges personalizados -->
                <div class="badges-container">
                  <div *ngIf="articulo.en_oferta" class="badge-oferta">¡OFERTA!</div>
                  <div *ngFor="let badge of articulo.badges" class="badge-custom">{{badge}}</div>
                </div>
                
                <!-- Badge de stock -->
                <div class="badge-stock" [class.stock-bajo]="articulo.stock < 10">
                  Stock: {{articulo.stock}}
                </div>
              </div>

              <!-- Información del producto -->
              <div class="articulo-info">
                <div class="articulo-categoria">{{getCategoriaNombre(articulo.categoria)}}</div>
                <h3 class="articulo-nombre">{{articulo.nombre}}</h3>
                <p class="articulo-descripcion">{{articulo.descripcion}}</p>
                
                <!-- Marca -->
                <div class="articulo-marca" *ngIf="articulo.marca">
                  <svg class="marca-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                  </svg>
                  {{getMarcaNombre(articulo.marca)}}
                </div>

                <!-- Características Visuales -->
                <ul class="articulo-caracteristicas" *ngIf="articulo.caracteristicas_visuales && articulo.caracteristicas_visuales.length > 0">
                  <li *ngFor="let caracteristica of articulo.caracteristicas_visuales.slice(0, 4)">
                    {{caracteristica}}
                  </li>
                </ul>

                <!-- Precio -->
                <div class="articulo-precio">
                  <span *ngIf="articulo.en_oferta && articulo.precio_original" class="precio-original">
                    {{formatearPrecio(articulo.precio_original)}}
                  </span>
                  <span class="precio-actual" [class.precio-oferta]="articulo.en_oferta">
                    {{formatearPrecio(articulo.precio)}}
                  </span>
                </div>

                <!-- Botón de contacto -->
                <button class="btn-contactar" (click)="contactarPorArticulo(articulo)">
                  <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.89 3.488"/>
                  </svg>
                  Consultar
                </button>

              </div>
            </div>
          </div>

          <!-- Mensaje si no hay productos -->
          <div *ngIf="!cargando && articulosFiltrados.length === 0" class="no-productos">
            <div class="no-productos-content">
              <svg class="no-productos-icon" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
              <h3>No se encontraron productos</h3>
              <p>Intenta ajustar los filtros o la búsqueda</p>
              <button class="btn-limpiar-filtros" (click)="limpiarFiltros()">Limpiar Filtros</button>
            </div>
          </div>

        </main>
      </div>
    </div>
  </div>
</div>

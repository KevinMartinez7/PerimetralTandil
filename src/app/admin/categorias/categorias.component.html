<div class="categorias-container">
  <!-- Header -->
  <header class="admin-header">
    <div class="header-content">
      <div class="header-left">
        <a routerLink="/admin/dashboard" class="back-btn">â† Volver</a>
        <h1>GestiÃ³n de CategorÃ­as</h1>
      </div>
      <div class="header-right">
        <button class="btn-primary" (click)="openCreateModal()">
          + Nueva CategorÃ­a
        </button>
        <button class="btn-logout" (click)="logout()">
          Cerrar SesiÃ³n
        </button>
      </div>
    </div>
  </header>

  <!-- Filtros -->
  <div class="filters-section">
    <div class="filters-content">
      <div class="filter-group">
        <input
          type="text"
          placeholder="Buscar categorÃ­as..."
          [(ngModel)]="searchTerm"
          class="search-input"
        />
      </div>

      <div class="filter-group">
        <select [(ngModel)]="selectedTipo" class="filter-select">
          <option value="">Todos los tipos</option>
          <option value="cerco">Cercos Perimetrales</option>
          <option value="rural">ArtÃ­culos Rurales</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Lista de CategorÃ­as -->
  <div class="categorias-content">
    <div class="loading-state" *ngIf="loading">
      <p>Cargando categorÃ­as...</p>
    </div>

    <div class="categorias-grid" *ngIf="!loading">
      <div class="categoria-card" *ngFor="let categoria of filteredCategorias">
        <div class="categoria-header">
          <div class="categoria-icon" [class.cerco]="categoria.tipo === 'cerco'" [class.rural]="categoria.tipo === 'rural'">
            <span *ngIf="categoria.tipo === 'cerco'">ğŸ </span>
            <span *ngIf="categoria.tipo === 'rural'">ğŸŒ¾</span>
          </div>
          <span class="tipo-badge" [class.cerco]="categoria.tipo === 'cerco'" [class.rural]="categoria.tipo === 'rural'">
            {{ categoria.tipo === 'cerco' ? 'Cerco Perimetral' : 'ArtÃ­culo Rural' }}
          </span>
        </div>

        <div class="categoria-info">
          <h3>{{ categoria.nombre }}</h3>
          <p class="categoria-descripcion" *ngIf="categoria.descripcion">
            {{ categoria.descripcion }}
          </p>
          <p class="categoria-descripcion empty" *ngIf="!categoria.descripcion">
            Sin descripciÃ³n
          </p>
        </div>

        <div class="categoria-actions">
          <button class="btn-edit" (click)="openEditModal(categoria)">
            âœï¸ Editar
          </button>
          <button class="btn-delete" (click)="openDeleteModal(categoria)">
            ğŸ—‘ï¸ Eliminar
          </button>
        </div>
      </div>

      <div class="empty-state" *ngIf="filteredCategorias.length === 0">
        <div class="empty-icon">ğŸ“</div>
        <p>No se encontraron categorÃ­as</p>
        <button class="btn-create-empty" (click)="openCreateModal()">
          + Crear Primera CategorÃ­a
        </button>
      </div>
    </div>
  </div>

  <!-- Modal Crear/Editar -->
  <div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ editMode ? 'Editar CategorÃ­a' : 'Nueva CategorÃ­a' }}</h2>
        <button class="close-btn" (click)="closeModal()">Ã—</button>
      </div>

      <form (ngSubmit)="saveCategoria()" class="categoria-form">
        <div class="form-group">
          <label for="nombre">Nombre de la CategorÃ­a *</label>
          <input
            type="text"
            id="nombre"
            [(ngModel)]="currentCategoria.nombre"
            name="nombre"
            placeholder="Ej: Alambrados, Tranqueras, Portones..."
            required
          />
        </div>

        <div class="form-group">
          <label for="tipo">Tipo de CategorÃ­a *</label>
          <select
            id="tipo"
            [(ngModel)]="currentCategoria.tipo"
            name="tipo"
            required
          >
            <option value="cerco">ğŸ  Cercos Perimetrales (Urbano/Ciudad)</option>
            <option value="rural">ğŸŒ¾ ArtÃ­culos Rurales (Campo)</option>
          </select>
          <small class="tipo-info">
            <span *ngIf="currentCategoria.tipo === 'cerco'" class="badge-cerco">
              Esta categorÃ­a aparecerÃ¡ en la secciÃ³n de Cercos Perimetrales
            </span>
            <span *ngIf="currentCategoria.tipo === 'rural'" class="badge-rural">
              Esta categorÃ­a aparecerÃ¡ en la secciÃ³n de ArtÃ­culos Rurales
            </span>
          </small>
        </div>

        <div class="form-group">
          <label for="descripcion">DescripciÃ³n (Opcional)</label>
          <textarea
            id="descripcion"
            [(ngModel)]="currentCategoria.descripcion"
            name="descripcion"
            rows="4"
            placeholder="Describe brevemente esta categorÃ­a..."
          ></textarea>
        </div>

        <div class="modal-actions">
          <button type="button" class="btn-cancel" (click)="closeModal()">
            Cancelar
          </button>
          <button type="submit" class="btn-save">
            {{ editMode ? 'Actualizar' : 'Crear' }} CategorÃ­a
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal de ConfirmaciÃ³n de EliminaciÃ³n -->
  <div class="modal-overlay" *ngIf="showDeleteModal" (click)="closeDeleteModal()">
    <div class="modal-delete" (click)="$event.stopPropagation()">
      <div class="modal-delete-icon">
        <span>âš ï¸</span>
      </div>
      <h2 class="modal-delete-title">Â¿EstÃ¡s seguro de que deseas eliminar esta categorÃ­a?</h2>
      <p class="modal-delete-text" *ngIf="categoriaToDelete">
        Se eliminarÃ¡ permanentemente la categorÃ­a <strong>"{{ categoriaToDelete.nombre }}"</strong>.
        <br><br>
        <span class="warning-text">âš ï¸ Nota: No podrÃ¡s eliminar esta categorÃ­a si tiene productos asociados.</span>
      </p>
      <div class="modal-delete-actions">
        <button type="button" class="btn-delete-cancel" (click)="closeDeleteModal()">
          Cancelar
        </button>
        <button type="button" class="btn-delete-confirm" (click)="confirmDelete()">
          SÃ­, eliminar
        </button>
      </div>
    </div>
  </div>

  <!-- Modal de Ã‰xito -->
  <div class="modal-overlay" *ngIf="showSuccessModal" (click)="closeSuccessModal()">
    <div class="modal-success" (click)="$event.stopPropagation()">
      <div class="modal-success-icon">
        <span>âœ“</span>
      </div>
      <h2 class="modal-success-title">Â¡OperaciÃ³n Exitosa!</h2>
      <p class="modal-success-text">
        {{ successMessage }}
      </p>
      <div class="modal-success-actions">
        <button type="button" class="btn-success-ok" (click)="closeSuccessModal()">
          Entendido
        </button>
      </div>
    </div>
  </div>
</div>
